<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Framed Camera Capture</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="app">
    <h1>프레임 안쪽만 캡처</h1>

    <div class="controls">
      <button id="startBtn">카메라 시작</button>
      <button id="shotBtn" disabled>캡처</button>
      <a id="downloadLink" download="capture.png" class="hidden">다운로드</a>
    </div>

    <div id="cameraWrap" class="camera-wrap">
      <!-- 실시간 비디오 -->
      <video id="video" playsinline autoplay muted></video>

      <!-- 어두운 오버레이 + 구멍(프레임)은 SVG 마스크로 -->
      <svg class="overlay" viewBox="0 0 100 100" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <mask id="holeMask">
            <!-- 전체 흰색(보임) -->
            <rect x="0" y="0" width="100" height="100" fill="white"></rect>
            <!-- 프레임 영역만 투명(구멍)으로 만들기 위해 검은색 -->
            <!-- 라운드 사각형 프레임 -->
            <rect id="frameRect" x="20" y="20" width="60" height="60" rx="8" ry="8" fill="black"></rect>

            <!-- 원형 프레임으로 쓰고싶으면 위 rect 대신 아래 circle 사용
            <circle id="frameCircle" cx="50" cy="50" r="30" fill="black"></circle>
            -->
          </mask>
        </defs>
        <!-- 어두운 레이어(구멍난 부분만 비디오가 보이도록) -->
        <rect x="0" y="0" width="100" height="100" fill="rgba(0,0,0,0.5)" mask="url(#holeMask)"></rect>
      </svg>

      <!-- 프레임의 실제 픽셀 위치를 계산하기 위한 보조 박스(보이지 않음) -->
      <div id="frameProbe" class="frame-probe"></div>
    </div>

    <div class="result">
      <h2>결과 미리보기</h2>
      <img id="preview" alt="capture preview" />
    </div>

    <!-- 캡처용 캔버스(화면에는 숨김) -->
    <canvas id="canvas" class="hidden"></canvas>

    <script type="module" src="/src/camara/app.ts"></script>
  </main>
</body>
</html>
