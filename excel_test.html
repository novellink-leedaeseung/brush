<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Excel 읽기/쓰기 데모</title>
</head>
<body style="margin:0;padding:24px;font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(#eef4fb,#dfe9f4);">

<div style="max-width:900px;margin:0 auto;background:#fff;border-radius:16px;box-shadow:0 8px 24px rgba(0,0,0,.08);padding:20px;">
    <h2 style="margin:0 0 16px 0;color:#0b4a93;">JavaScript로 엑셀 적용하기 (읽기 & 쓰기)</h2>

    <!-- ========== 엑셀 읽기 ========== -->
    <div style="display:flex;gap:12px;align-items:center;margin:0 0 12px 0;">
        <input id="file" type="file" accept=".xlsx,.xls"
               style="flex:1;padding:10px;border:1px solid #e5e7eb;border-radius:10px;background:#f9fafb;">
        <button onclick="readExcel()"
                style="height:42px;padding:0 16px;background:#004F99;color:#fff;border:none;border-radius:10px;font-weight:700;cursor:pointer;">
            엑셀 불러오기
        </button>
    </div>
    <div id="preview"
         style="overflow:auto;border:1px solid #eef2f7;border-radius:10px;padding:12px;background:#fafbff;max-height:320px;"></div>

    <div style="height:24px;"></div>

    <!-- ========== 엑셀 쓰기(다운로드) ========== -->
    <div style="display:flex;gap:12px;align-items:center;">
        <button onclick="downloadExcel()"
                style="height:48px;padding:0 16px;background:#0B5DB1;color:#fff;border:none;border-radius:12px;font-weight:800;cursor:pointer;box-shadow:0 4px 12px rgba(11,93,177,.25);">
            샘플 데이터 XLSX 다운로드
        </button>
        <span style="color:#475569;font-size:14px;">버튼을 누르면 메모리상의 데이터를 엑셀(.xlsx)로 저장합니다.</span>
    </div>
</div>

<!-- SheetJS -->
<script src="/public/xlsx.full.min.js"></script>
<script>

    // ========== 엑셀 쓰기(다운로드) ========== //
    function downloadExcel() {
        // 샘플 데이터 (여기에 실제 수집/조회한 데이터를 넣으면 됨)
        const aoa = [
            ['날짜', '시간', '학년', '반', '이름', '점심시간여부'],
            ['2025.09.12', '11:30', '2', '3', '김민준', 'Y'],
            ['2025.09.12', '11:45', '1', '4', '이서연', 'Y'],
            ['2025.09.12', '12:00', '3', '1', '박지호', 'Y'],
            ['2025.09.12', '12:15', '2', '2', '최수아', 'Y'],
            ['2025.09.12', '13:00', '1', '1', '정우진', 'N'],
            ['2025.09.12', '13:15', '3', '2', '강하은', 'N'],
            ['2025.09.12', '13:30', '2', '4', '임도현', 'N'],
            ['2025.09.12', '13:45', '1', '3', '윤지민', 'N'],
            ['2025.09.12', '14:00', '3', '4', '송현우', 'N'],
            ['2025.09.12', '14:15', '2', '1', '한소희', 'N']
        ];

        const ws = XLSX.utils.aoa_to_sheet(aoa);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Records');

        // 파일 다운로드
        XLSX.writeFile(wb, 'meditouch_records.xlsx', {compression: true});
    }
</script>
</body>
</html>
